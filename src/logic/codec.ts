// src/logic/codec.ts
import type { Certainty } from '../types';

// 1. ä½ çš„å®Œæ•´ Emoji å­—å…¸ (è¯·æŠŠæ–‡ä»¶é‡Œçš„å®Œæ•´æ•°ç»„è´´åœ¨è¿™é‡Œ)
const EMOJI_MAP: string[] = [
        'ğŸ†˜', 'ğŸ†™', 'ğŸ†š', 'ğŸˆ', 'ğŸˆ‚', 'ğŸˆš', 'ğŸˆ¯', 'ğŸˆ²', 'ğŸˆ³', 'ğŸˆ´', 'ğŸˆµ',
        'ğŸˆ¶', 'ğŸˆ·', 'ğŸˆ¸', 'ğŸˆ¹', 'ğŸˆº', 'ğŸ‰', 'ğŸ‰‘', 'ğŸŒ€', 'ğŸŒ', 'ğŸŒ‚',
        'ğŸŒƒ', 'ğŸŒ„', 'ğŸŒ…', 'ğŸŒ†', 'ğŸŒ‡', 'ğŸŒˆ', 'ğŸŒ‰', 'ğŸŒŠ', 'ğŸŒ‹', 'ğŸŒŒ',
        'ğŸŒ', 'ğŸŒ', 'ğŸŒ', 'ğŸŒ', 'ğŸŒ‘', 'ğŸŒ’', 'ğŸŒ“', 'ğŸŒ”', 'ğŸŒ•', 'ğŸŒ–',
        'ğŸŒ—', 'ğŸŒ˜', 'ğŸŒ™', 'ğŸŒš', 'ğŸŒ›', 'ğŸŒœ', 'ğŸŒ', 'ğŸŒ', 'ğŸŒŸ', 'ğŸŒ ',
        'ğŸŒ¡', 'ğŸŒ¤', 'ğŸŒ¥', 'ğŸŒ¦', 'ğŸŒ§', 'ğŸŒ¨', 'ğŸŒ©', 'ğŸŒª', 'ğŸŒ«', 'ğŸŒ¬',
        'ğŸŒ­', 'ğŸŒ®', 'ğŸŒ¯', 'ğŸŒ°', 'ğŸŒ±', 'ğŸŒ²', 'ğŸŒ³', 'ğŸŒ´', 'ğŸŒµ', 'ğŸŒ¶',
        'ğŸŒ·', 'ğŸŒ¸', 'ğŸŒ¹', 'ğŸŒº', 'ğŸŒ»', 'ğŸŒ¼', 'ğŸŒ½', 'ğŸŒ¾', 'ğŸŒ¿', 'ğŸ€',
        'ğŸ', 'ğŸ‚', 'ğŸƒ', 'ğŸ„', 'ğŸ…', 'ğŸ†', 'ğŸ‡', 'ğŸˆ', 'ğŸ‰', 'ğŸŠ',
        'ğŸ‹', 'ğŸŒ', 'ğŸ', 'ğŸ', 'ğŸ', 'ğŸ', 'ğŸ‘', 'ğŸ’', 'ğŸ“', 'ğŸ”',
        'ğŸ•', 'ğŸ–', 'ğŸ—', 'ğŸ˜', 'ğŸ™', 'ğŸš', 'ğŸ›', 'ğŸœ', 'ğŸ', 'ğŸ',
        'ğŸŸ', 'ğŸ ', 'ğŸ¡', 'ğŸ¢', 'ğŸ£', 'ğŸ¤', 'ğŸ¥', 'ğŸ¦', 'ğŸ§', 'ğŸ¨',
        'ğŸ©', 'ğŸª', 'ğŸ«', 'ğŸ¬', 'ğŸ­', 'ğŸ®', 'ğŸ¯', 'ğŸ°', 'ğŸ±', 'ğŸ²',
        'ğŸ³', 'ğŸ´', 'ğŸµ', 'ğŸ¶', 'ğŸ·', 'ğŸ¸', 'ğŸ¹', 'ğŸº', 'ğŸ»', 'ğŸ¼',
        'ğŸ½', 'ğŸ¾', 'ğŸ¿', 'ğŸ€', 'ğŸ', 'ğŸ‚', 'ğŸƒ', 'ğŸ„', 'ğŸ…', 'ğŸ†',
        'ğŸ‡', 'ğŸˆ', 'ğŸ‰', 'ğŸŠ', 'ğŸ‹', 'ğŸŒ', 'ğŸ', 'ğŸ', 'ğŸ', 'ğŸ',
        'ğŸ‘', 'ğŸ’', 'ğŸ“', 'ğŸ–', 'ğŸ—', 'ğŸ™', 'ğŸš', 'ğŸ›', 'ğŸ', 'ğŸŸ',
        'ğŸ ', 'ğŸ¡', 'ğŸ¢', 'ğŸ£', 'ğŸ¤', 'ğŸ¥', 'ğŸ¦', 'ğŸ§', 'ğŸ¨', 'ğŸ©',
        'ğŸª', 'ğŸ«', 'ğŸ¬', 'ğŸ­', 'ğŸ®', 'ğŸ¯', 'ğŸ°', 'ğŸ±', 'ğŸ²', 'ğŸ³',
        'ğŸ´', 'ğŸµ', 'ğŸ¶', 'ğŸ·', 'ğŸ¸', 'ğŸ¹', 'ğŸº', 'ğŸ»', 'ğŸ¼', 'ğŸ½',
        'ğŸ¾', 'ğŸ¿', 'ğŸ€', 'ğŸ', 'ğŸ‚', 'ğŸƒ', 'ğŸ„', 'ğŸ…', 'ğŸ†', 'ğŸ‡',
        'ğŸˆ', 'ğŸ‰', 'ğŸŠ', 'ğŸ‹', 'ğŸŒ', 'ğŸ', 'ğŸ', 'ğŸ', 'ğŸ', 'ğŸ‘',
        'ğŸ’', 'ğŸ“', 'ğŸ”', 'ğŸ•', 'ğŸ–', 'ğŸ—', 'ğŸ˜', 'ğŸ™', 'ğŸš', 'ğŸ›',
        'ğŸœ', 'ğŸ', 'ğŸ', 'ğŸŸ', 'ğŸ ', 'ğŸ¡', 'ğŸ¢', 'ğŸ£', 'ğŸ¤', 'ğŸ¥',
        'ğŸ¦', 'ğŸ§', 'ğŸ¨', 'ğŸ©', 'ğŸª', 'ğŸ«', 'ğŸ¬', 'ğŸ­', 'ğŸ®', 'ğŸ¯',
        'ğŸ°', 'ğŸ³', 'ğŸ´', 'ğŸµ', 'ğŸ·', 'ğŸ¸', 'ğŸ¹', 'ğŸº', 'ğŸ€', 'ğŸ',
        'ğŸ‚', 'ğŸƒ', 'ğŸ„', 'ğŸ…', 'ğŸ†', 'ğŸ‡', 'ğŸˆ', 'ğŸ‰', 'ğŸŠ', 'ğŸ‹',
        'ğŸŒ', 'ğŸ', 'ğŸ', 'ğŸ', 'ğŸ', 'ğŸ‘', 'ğŸ’', 'ğŸ“', 'ğŸ”', 'ğŸ•',
        'ğŸ–', 'ğŸ—', 'ğŸ˜', 'ğŸ™', 'ğŸš', 'ğŸ›', 'ğŸœ', 'ğŸ', 'ğŸ', 'ğŸŸ',
        'ğŸ ', 'ğŸ¡', 'ğŸ¢', 'ğŸ£', 'ğŸ¤', 'ğŸ¥', 'ğŸ¦', 'ğŸ§', 'ğŸ¨', 'ğŸ©',
        'ğŸª', 'ğŸ«', 'ğŸ¬', 'ğŸ­', 'ğŸ®', 'ğŸ¯', 'ğŸ°', 'ğŸ±', 'ğŸ²', 'ğŸ³',
        'ğŸ´', 'ğŸµ', 'ğŸ¶', 'ğŸ·', 'ğŸ¸', 'ğŸ¹', 'ğŸº', 'ğŸ»', 'ğŸ¼', 'ğŸ½',
        'ğŸ¾', 'ğŸ¿', 'ğŸ‘€', 'ğŸ‘', 'ğŸ‘‚', 'ğŸ‘ƒ', 'ğŸ‘„', 'ğŸ‘…', 'ğŸ‘†', 'ğŸ‘‡',
        'ğŸ‘ˆ', 'ğŸ‘‰', 'ğŸ‘Š', 'ğŸ‘‹', 'ğŸ‘Œ', 'ğŸ‘', 'ğŸ‘', 'ğŸ‘', 'ğŸ‘', 'ğŸ‘‘',
        'ğŸ‘’', 'ğŸ‘“', 'ğŸ‘”', 'ğŸ‘•', 'ğŸ‘–', 'ğŸ‘—', 'ğŸ‘˜', 'ğŸ‘™', 'ğŸ‘š', 'ğŸ‘›',
        'ğŸ‘œ', 'ğŸ‘', 'ğŸ‘', 'ğŸ‘Ÿ', 'ğŸ‘ ', 'ğŸ‘¡', 'ğŸ‘¢', 'ğŸ‘£', 'ğŸ‘¤', 'ğŸ‘¥',
        'ğŸ‘¦', 'ğŸ‘§', 'ğŸ‘¨', 'ğŸ‘©', 'ğŸ‘ª', 'ğŸ‘«', 'ğŸ‘¬', 'ğŸ‘­', 'ğŸ‘®', 'ğŸ‘¯',
        'ğŸ‘°', 'ğŸ‘±', 'ğŸ‘²', 'ğŸ‘³', 'ğŸ‘´', 'ğŸ‘µ', 'ğŸ‘¶', 'ğŸ‘·', 'ğŸ‘¸', 'ğŸ‘¹',
        'ğŸ‘º', 'ğŸ‘»', 'ğŸ‘¼', 'ğŸ‘½', 'ğŸ‘¾', 'ğŸ‘¿', 'ğŸ’€', 'ğŸ’', 'ğŸ’‚', 'ğŸ’ƒ',
        'ğŸ’„', 'ğŸ’…', 'ğŸ’†', 'ğŸ’‡', 'ğŸ’ˆ', 'ğŸ’‰', 'ğŸ’Š', 'ğŸ’‹', 'ğŸ’Œ', 'ğŸ’',
        'ğŸ’', 'ğŸ’', 'ğŸ’', 'ğŸ’‘', 'ğŸ’’', 'ğŸ’“', 'ğŸ’”', 'ğŸ’•', 'ğŸ’–', 'ğŸ’—',
        'ğŸ’˜', 'ğŸ’™', 'ğŸ’š', 'ğŸ’›', 'ğŸ’œ', 'ğŸ’', 'ğŸ’', 'ğŸ’Ÿ', 'ğŸ’ ', 'ğŸ’¡',
        'ğŸ’¢', 'ğŸ’£', 'ğŸ’¤', 'ğŸ’¥', 'ğŸ’¦', 'ğŸ’§', 'ğŸ’¨', 'ğŸ’©', 'ğŸ’ª', 'ğŸ’«',
        'ğŸ’¬', 'ğŸ’­', 'ğŸ’®', 'ğŸ’¯', 'ğŸ’°', 'ğŸ’±', 'ğŸ’²', 'ğŸ’³', 'ğŸ’´', 'ğŸ’µ',
        'ğŸ’¶', 'ğŸ’·', 'ğŸ’¸', 'ğŸ’¹', 'ğŸ’º', 'ğŸ’»', 'ğŸ’¼', 'ğŸ’½', 'ğŸ’¾', 'ğŸ’¿',
        'ğŸ“€', 'ğŸ“', 'ğŸ“‚', 'ğŸ“ƒ', 'ğŸ“„', 'ğŸ“…', 'ğŸ“†', 'ğŸ“‡', 'ğŸ“ˆ', 'ğŸ“‰',
        'ğŸ“Š', 'ğŸ“‹', 'ğŸ“Œ', 'ğŸ“', 'ğŸ“', 'ğŸ“', 'ğŸ“', 'ğŸ“‘', 'ğŸ“’', 'ğŸ““',
        'ğŸ“”', 'ğŸ“•', 'ğŸ“–', 'ğŸ“—', 'ğŸ“˜', 'ğŸ“™', 'ğŸ“š', 'ğŸ“›', 'ğŸ“œ', 'ğŸ“',
        'ğŸ“', 'ğŸ“Ÿ', 'ğŸ“ ', 'ğŸ“¡', 'ğŸ“¢', 'ğŸ“£', 'ğŸ“¤', 'ğŸ“¥', 'ğŸ“¦', 'ğŸ“§',
        'ğŸ“¨', 'ğŸ“©', 'ğŸ“ª', 'ğŸ“«', 'ğŸ“¬', 'ğŸ“­', 'ğŸ“®', 'ğŸ“¯', 'ğŸ“°', 'ğŸ“±',
        'ğŸ“²', 'ğŸ“³', 'ğŸ“´', 'ğŸ“µ', 'ğŸ“¶', 'ğŸ“·', 'ğŸ“¸', 'ğŸ“¹', 'ğŸ“º', 'ğŸ“»',
        'ğŸ“¼', 'ğŸ“½', 'ğŸ“¿', 'ğŸ”€', 'ğŸ”', 'ğŸ”‚', 'ğŸ”ƒ', 'ğŸ”„', 'ğŸ”…', 'ğŸ”†',
        'ğŸ”‡', 'ğŸ”ˆ', 'ğŸ”‰', 'ğŸ”Š', 'ğŸ”‹', 'ğŸ”Œ', 'ğŸ”', 'ğŸ”', 'ğŸ”', 'ğŸ”',
        'ğŸ”‘', 'ğŸ”’', 'ğŸ”“', 'ğŸ””', 'ğŸ”•', 'ğŸ”–', 'ğŸ”—', 'ğŸ”˜', 'ğŸ”™', 'ğŸ”š',
        'ğŸ”›', 'ğŸ”œ', 'ğŸ”', 'ğŸ”', 'ğŸ”Ÿ', 'ğŸ” ', 'ğŸ”¡', 'ğŸ”¢', 'ğŸ”£', 'ğŸ”¤',
        'ğŸ”¥', 'ğŸ”¦', 'ğŸ”§', 'ğŸ”¨', 'ğŸ”©', 'ğŸ”ª', 'ğŸ”«', 'ğŸ”¬', 'ğŸ”­', 'ğŸ”®',
        'ğŸ”¯', 'ğŸ”°', 'ğŸ”±', 'ğŸ”²', 'ğŸ”³', 'ğŸ”´', 'ğŸ”µ', 'ğŸ”¶', 'ğŸ”·', 'ğŸ”¸',
        'ğŸ”¹', 'ğŸ”º', 'ğŸ”»', 'ğŸ”¼', 'ğŸ”½', 'ğŸ•‰', 'ğŸ•Š', 'ğŸ•‹', 'ğŸ•Œ', 'ğŸ•',
        'ğŸ•', 'ğŸ•', 'ğŸ•‘', 'ğŸ•’', 'ğŸ•“', 'ğŸ•”', 'ğŸ••', 'ğŸ•–', 'ğŸ•—', 'ğŸ•˜',
        'ğŸ•™', 'ğŸ•š', 'ğŸ•›', 'ğŸ•œ', 'ğŸ•', 'ğŸ•', 'ğŸ•Ÿ', 'ğŸ• ', 'ğŸ•¡', 'ğŸ•¢',
        'ğŸ•£', 'ğŸ•¤', 'ğŸ•¥', 'ğŸ•¦', 'ğŸ•§', 'ğŸ•¯', 'ğŸ•°', 'ğŸ•³', 'ğŸ•´', 'ğŸ•µ',
        'ğŸ•¶', 'ğŸ•·', 'ğŸ•¸', 'ğŸ•¹', 'ğŸ•º', 'ğŸ–‡', 'ğŸ–Š', 'ğŸ–‹', 'ğŸ–Œ', 'ğŸ–',
        'ğŸ–', 'ğŸ–•', 'ğŸ––', 'ğŸ–¤', 'ğŸ–¥', 'ğŸ–¨', 'ğŸ–±', 'ğŸ–²', 'ğŸ–¼', 'ğŸ—‚',
        'ğŸ—ƒ', 'ğŸ—„', 'ğŸ—‘', 'ğŸ—’', 'ğŸ—“', 'ğŸ—œ', 'ğŸ—', 'ğŸ—', 'ğŸ—¡', 'ğŸ—£',
        'ğŸ—¨', 'ğŸ—¯', 'ğŸ—³', 'ğŸ—º', 'ğŸ—»', 'ğŸ—¼', 'ğŸ—½', 'ğŸ—¾', 'ğŸ—¿', 'ğŸ˜€',
        'ğŸ˜', 'ğŸ˜‚', 'ğŸ˜ƒ', 'ğŸ˜„', 'ğŸ˜…', 'ğŸ˜†', 'ğŸ˜‡', 'ğŸ˜ˆ', 'ğŸ˜‰', 'ğŸ˜Š',
        'ğŸ˜‹', 'ğŸ˜Œ', 'ğŸ˜', 'ğŸ˜', 'ğŸ˜', 'ğŸ˜', 'ğŸ˜‘', 'ğŸ˜’', 'ğŸ˜“', 'ğŸ˜”',
        'ğŸ˜•', 'ğŸ˜–', 'ğŸ˜—', 'ğŸ˜˜', 'ğŸ˜™', 'ğŸ˜š', 'ğŸ˜›', 'ğŸ˜œ', 'ğŸ˜', 'ğŸ˜',
        'ğŸ˜Ÿ', 'ğŸ˜ ', 'ğŸ˜¡', 'ğŸ˜¢', 'ğŸ˜£', 'ğŸ˜¤', 'ğŸ˜¥', 'ğŸ˜¦', 'ğŸ˜§', 'ğŸ˜¨',
        'ğŸ˜©', 'ğŸ˜ª', 'ğŸ˜«', 'ğŸ˜¬', 'ğŸ˜­', 'ğŸ˜®', 'ğŸ˜¯', 'ğŸ˜°', 'ğŸ˜±', 'ğŸ˜²',
        'ğŸ˜³', 'ğŸ˜´', 'ğŸ˜µ', 'ğŸ˜¶', 'ğŸ˜·', 'ğŸ˜¸', 'ğŸ˜¹', 'ğŸ˜º', 'ğŸ˜»', 'ğŸ˜¼',
        'ğŸ˜½', 'ğŸ˜¾', 'ğŸ˜¿', 'ğŸ™€', 'ğŸ™', 'ğŸ™‚', 'ğŸ™ƒ', 'ğŸ™„', 'ğŸ™…', 'ğŸ™†',
        'ğŸ™‡', 'ğŸ™ˆ', 'ğŸ™‰', 'ğŸ™Š', 'ğŸ™‹', 'ğŸ™Œ', 'ğŸ™', 'ğŸ™', 'ğŸ™', 'ğŸš€',
        'ğŸš', 'ğŸš‚', 'ğŸšƒ', 'ğŸš„', 'ğŸš…', 'ğŸš†', 'ğŸš‡', 'ğŸšˆ', 'ğŸš‰', 'ğŸšŠ',
        'ğŸš‹', 'ğŸšŒ', 'ğŸš', 'ğŸš', 'ğŸš', 'ğŸš', 'ğŸš‘', 'ğŸš’', 'ğŸš“', 'ğŸš”',
        'ğŸš•', 'ğŸš–', 'ğŸš—', 'ğŸš˜', 'ğŸš™', 'ğŸšš', 'ğŸš›', 'ğŸšœ', 'ğŸš', 'ğŸš',
        'ğŸšŸ', 'ğŸš ', 'ğŸš¡', 'ğŸš¢', 'ğŸš£', 'ğŸš¤', 'ğŸš¥', 'ğŸš¦', 'ğŸš§', 'ğŸš¨',
        'ğŸš©', 'ğŸšª', 'ğŸš«', 'ğŸš¬', 'ğŸš­', 'ğŸš®', 'ğŸš¯', 'ğŸš°', 'ğŸš±', 'ğŸš²',
        'ğŸš³', 'ğŸš´', 'ğŸšµ', 'ğŸš¶', 'ğŸš·', 'ğŸš¸', 'ğŸš¹', 'ğŸšº', 'ğŸš»', 'ğŸš¼',
        'ğŸš½', 'ğŸš¾', 'ğŸš¿', 'ğŸ›€', 'ğŸ›', 'ğŸ›‚', 'ğŸ›ƒ', 'ğŸ›„', 'ğŸ›…', 'ğŸ›‹',
        'ğŸ›Œ', 'ğŸ›', 'ğŸ›', 'ğŸ›', 'ğŸ›', 'ğŸ›‘', 'ğŸ›’', 'ğŸ› ', 'ğŸ›¡', 'ğŸ›¢',
        'ğŸ›£', 'ğŸ›¤', 'ğŸ›¥', 'ğŸ›©', 'ğŸ›«', 'ğŸ›¬', 'ğŸ›°', 'ğŸ›³', 'ğŸ›´', 'ğŸ›µ',
        'ğŸ›¶', 'ğŸ›·', 'ğŸ›¸', 'ğŸ›¹', 'ğŸ¤', 'ğŸ¤‘', 'ğŸ¤’', 'ğŸ¤“', 'ğŸ¤”', 'ğŸ¤•',
        'ğŸ¤–', 'ğŸ¤—', 'ğŸ¤˜', 'ğŸ¤™', 'ğŸ¤š', 'ğŸ¤›', 'ğŸ¤œ', 'ğŸ¤', 'ğŸ¤', 'ğŸ¤Ÿ',
        'ğŸ¤ ', 'ğŸ¤¡', 'ğŸ¤¢', 'ğŸ¤£', 'ğŸ¤¤', 'ğŸ¤¥', 'ğŸ¤¦', 'ğŸ¤§', 'ğŸ¤¨', 'ğŸ¤©',
        'ğŸ¤ª', 'ğŸ¤«', 'ğŸ¤¬', 'ğŸ¤­', 'ğŸ¤®', 'ğŸ¤¯', 'ğŸ¤°', 'ğŸ¤±', 'ğŸ¤²', 'ğŸ¤³',
        'ğŸ¤´', 'ğŸ¤µ', 'ğŸ¤¶', 'ğŸ¤·', 'ğŸ¤¸', 'ğŸ¤¹', 'ğŸ¤º', 'ğŸ¤¼', 'ğŸ¤½', 'ğŸ¤¾',
        'ğŸ¥€', 'ğŸ¥', 'ğŸ¥‚', 'ğŸ¥ƒ', 'ğŸ¥„', 'ğŸ¥…', 'ğŸ¥‡', 'ğŸ¥ˆ', 'ğŸ¥‰', 'ğŸ¥Š',
        'ğŸ¥‹', 'ğŸ¥Œ', 'ğŸ¥', 'ğŸ¥', 'ğŸ¥', 'ğŸ¥', 'ğŸ¥‘', 'ğŸ¥’', 'ğŸ¥“', 'ğŸ¥”',
        'ğŸ¥•', 'ğŸ¥–', 'ğŸ¥—', 'ğŸ¥˜', 'ğŸ¥™', 'ğŸ¥š', 'ğŸ¥›', 'ğŸ¥œ', 'ğŸ¥', 'ğŸ¥',
        'ğŸ¥Ÿ', 'ğŸ¥ ', 'ğŸ¥¡', 'ğŸ¥¢', 'ğŸ¥£', 'ğŸ¥¤', 'ğŸ¥¥', 'ğŸ¥¦', 'ğŸ¥§', 'ğŸ¥¨',
        'ğŸ¥©', 'ğŸ¥ª', 'ğŸ¥«', 'ğŸ¥¬', 'ğŸ¥­', 'ğŸ¥®', 'ğŸ¥¯', 'ğŸ¥°', 'ğŸ¥³', 'ğŸ¥´',
        'ğŸ¥µ', 'ğŸ¥¶', 'ğŸ¥º', 'ğŸ¥¼', 'ğŸ¥½', 'ğŸ¥¾', 'ğŸ¥¿', 'ğŸ¦€', 'ğŸ¦', 'ğŸ¦‚',
        'ğŸ¦ƒ', 'ğŸ¦„', 'ğŸ¦…', 'ğŸ¦†', 'ğŸ¦‡', 'ğŸ¦ˆ', 'ğŸ¦‰', 'ğŸ¦Š', 'ğŸ¦‹', 'ğŸ¦Œ',
        'ğŸ¦', 'ğŸ¦', 'ğŸ¦', 'ğŸ¦', 'ğŸ¦‘', 'ğŸ¦’', 'ğŸ¦“', 'ğŸ¦”', 'ğŸ¦•', 'ğŸ¦–',
        'ğŸ¦—', 'ğŸ¦˜', 'ğŸ¦™', 'ğŸ¦š', 'ğŸ¦›', 'ğŸ¦œ', 'ğŸ¦', 'ğŸ¦', 'ğŸ¦Ÿ', 'ğŸ¦ ',
        'ğŸ¦¡', 'ğŸ¦¢', 'ğŸ¦°', 'ğŸ¦±', 'ğŸ¦²', 'ğŸ¦³', 'ğŸ¦´', 'ğŸ¦µ', 'ğŸ¦¶', 'ğŸ¦·',
        'ğŸ¦¸', 'ğŸ¦¹', 'ğŸ§€', 'ğŸ§', 'ğŸ§‚', 'ğŸ§', 'ğŸ§‘', 'ğŸ§’', 'ğŸ§“', 'ğŸ§”',
        'ğŸ§•', 'ğŸ§–', 'ğŸ§—', 'ğŸ§˜', 'ğŸ§™', 'ğŸ§š', 'ğŸ§›', 'ğŸ§œ', 'ğŸ§', 'ğŸ§',
        'ğŸ§Ÿ', 'ğŸ§ ', 'ğŸ§¡', 'ğŸ§¢', 'ğŸ§£', 'ğŸ§¤', 'ğŸ§¥', 'ğŸ§¦', 'ğŸ§§', 'ğŸ§¨',
        'ğŸ§©', 'ğŸ§ª', 'ğŸ§«', 'ğŸ§¬', 'ğŸ§­', 'ğŸ§®', 'ğŸ§¯', 'ğŸ§°', 'ğŸ§±', 'ğŸ§²',
        'ğŸ§³', 'ğŸ§´', 'ğŸ§µ', 'ğŸ§¶', 'ğŸ§·', 'ğŸ§¸', 'ğŸ§¹', 'ğŸ§º', 'ğŸ§»', 'ğŸ§¼',
        'ğŸ§½', 'ğŸ§¾', 'ğŸ§¿', 'ğŸ†—'
];

// å»ºç«‹åå‘ç´¢å¼• (Emoji -> æ•°å­—)ï¼Œä¸ºäº†è§£ç åŠ é€Ÿ
const EMOJI_TO_INDEX = new Map<string, number>();
EMOJI_MAP.forEach((emoji, index) => {
  EMOJI_TO_INDEX.set(emoji, index);
});

// å•é¢˜ç­”æ¡ˆæ¥å£
interface Answer {
  option: number; // 0-5
  certainty: Certainty; // 0-3
}

/**
 * æ ¸å¿ƒç¼–ç å‡½æ•°ï¼šå°†ç­”æ¡ˆæ•°ç»„å‹ç¼©ä¸º Emoji å­—ç¬¦ä¸²
 * @param answers ç­”æ¡ˆæ•°ç»„ (æŒ‰é¢˜ç›®é¡ºåºæ’åˆ—)
 */
export function encode(answers: Answer[]): string {
  let result = "";
  
  // æ¯æ¬¡å¤„ç† 2 é“é¢˜
  for (let i = 0; i < answers.length; i += 2) {
    const q1 = answers[i] || { option: 0, certainty: 0 }; // ç¼ºçœè¡¥0
    const q2 = answers[i + 1] || { option: 0, certainty: 0 };

    // ã€ä½è¿ç®—é­”æ³•ã€‘
    // ç»“æ„: [Q1é€‰é¡¹ 3bit][Q1åšå®š 2bit] + [Q2é€‰é¡¹ 3bit][Q2åšå®š 2bit]
    // æ€»å…± 10 bits
    
    // 1. æ„å»º Q1 çš„ 5 bitsæ•°å€¼
    // ä¾‹å¦‚: é€‰é¡¹3(011) + åšå®š2(10) -> 01110 (åè¿›åˆ¶ 14)
    const val1 = (q1.option << 2) | q1.certainty;
    
    // 2. æ„å»º Q2 çš„ 5 bitsæ•°å€¼
    const val2 = (q2.option << 2) | q2.certainty;

    // 3. åˆå¹¶ä¸º 10 bits
    // val1 æ”¾é«˜ä½ï¼Œval2 æ”¾ä½ä½
    const combined = (val1 << 5) | val2;

    // 4. æŸ¥è¡¨è½¬ Emoji
    result += EMOJI_MAP[combined] || 'ğŸ†˜'; // å¦‚æœè¶Šç•Œ(ç†è®ºä¸ä¼š)ç”¨æ±‚æ•‘ç¬¦
  }

  return result;
}

/**
 * æ ¸å¿ƒè§£ç å‡½æ•°ï¼šå°† Emoji å­—ç¬¦ä¸²è¿˜åŸä¸ºç­”æ¡ˆæ•°ç»„
 */
export function decode(code: string): Answer[] {
  // è¿™æ˜¯ä¸€ä¸ª Array.from çš„æŠ€å·§ï¼Œèƒ½æ­£ç¡®å¤„ç† Emoji è¿™ç§å®½å­—ç¬¦
  const emojis = Array.from(code); 
  const answers: Answer[] = [];

  for (const emoji of emojis) {
    const value = EMOJI_TO_INDEX.get(emoji);
    
    if (value === undefined) {
      // é‡åˆ°ä¸è®¤è¯†çš„å­—ç¬¦ï¼Œè·³è¿‡æˆ–è¡¥ç©º
      answers.push({ option: 0, certainty: 0 });
      answers.push({ option: 0, certainty: 0 });
      continue;
    }

    // ã€ä½è¿ç®—é€†å‘é­”æ³•ã€‘
    
    // 1. æ‹†è§£å‡º Q1 (é«˜5ä½) å’Œ Q2 (ä½5ä½)
    const val1 = (value >> 5) & 0b11111; // 0b11111 å°±æ˜¯ 31
    const val2 = value & 0b11111;

    // 2. è§£æ Q1
    answers.push({
      option: (val1 >> 2),      //ä»¥æ­¤ç±»æ¨ï¼Œå–å‡ºå‰3ä½
      certainty: (val1 & 0b11) as Certainty // å–å‡ºå2ä½
    });

    // 3. è§£æ Q2
    answers.push({
      option: (val2 >> 2),
      certainty: (val2 & 0b11) as Certainty
    });
  }

  return answers;
}